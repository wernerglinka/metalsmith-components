{# 
  Collection List - Renders a paginated list of items from any collection
  Dynamically displays collection items with automatic author/date detection
  
  Required section properties:
  - collectionName: string - name of the collection to display (e.g., 'blog', 'components')
  
  Pagination params (populated by metalsmith-sectioned-blog-pagination):
  - numberOfPages: number - total number of pagination pages
  - pageNumber: number - current page number  
  - pageLength: number - items per page
  - pageStart: number - starting index for current page
#}
{% from "components/_partials/author-date/author-date.njk" import authorDate %}
{% from "components/_partials/card/card.njk" import card %}
{% from "components/_partials/collection-pagination/collection-pagination.njk" import collectionPagination %}

<div class="container">
  {% set params = section.pagingParams %}
  {% set collection = collections[section.collectionName] %}
  
  {% if params.numberOfPages > 1 %}
    {{ collectionPagination(params.numberOfPages, params.pageNumber, section.domainName) }}
    {% set startPage = params.pageStart %}
    {% set endPage = startPage + params.pageLength %}
  {% else %}
    {% set startPage = 0 %}
    {% set endPage = collection.length %}
  {% endif %}

  <ul class="collection-list">
    {% for item in collection %}
      {% if loop.index > startPage and loop.index <= endPage %}
        {# Build card object with all possible fields #}
        {% set thisCard = {
          title: item.card.title,
          prose: item.card.excerpt or item.card.description,
          thumbnail: item.card.image,
          link: "/" ~ item.permalink,
          horizontal: false,
          date: item.card.date,
          author: item.card.author
        } %}
        
        <li class="simple-card{% if params.horizontal %} is-horizontal{% endif %}">
          {{ card(thisCard) }}
        </li>
      {% endif %}
    {% endfor %}
  </ul>

  {% if params.numberOfPages > 1 %}
    {{ collectionPagination(params.numberOfPages, params.pageNumber, section.domainName) }}
  {% endif %}

</div>